{
  "wakeonlan-server": {
    "layout": "post",
    "title": "wakeonlan server",
    "date": "2021-12-12 10:18:10 +0100",
    "tags": "suspend, wakeonlan, hibernate, ubuntu",
    "preview": "Commands are for ubuntu.\n\n# Check hardware capability\n\nTo see if â€¦",
    "content": "\n\nCommands are for ubuntu.\n\n# Check hardware capability\n\nTo see if card is able to be \"awaken\":\n\n~~~bash\nsudo ethtool eth0  | egrep \"^[[:blank:]]*Wake-on: (g|d)\"\n~~~\n\nif `g`, it is activated, if `d`, this is possible but not activated.\n\nSee https://doc.ubuntu-fr.org/wakeonlan for more information.\n\n# Put server in hibernation or suspend it\n\nFor me, suspending activity is enough. It will consume power but will be accessible in few seconds.\n\nSee https://www.cyberciti.biz/faq/linux-command-to-suspend-hibernate-laptop-netbook-pc/\n\nBy pressing power button, the machine will be suspended or resumed (if already suspended)\n\nNow, how to suspend it?\n\nI would like to manually suspend it by pressing power button.\n\nSo `systemctl suspend` would be enough.\n\n## disabling systemd management\n\n\n~~~bash\nsudo sed -i s/\".*HandlePowerKey.*\"/\"HandlePowerKey=ignore\"/ /etc/systemd/logind.conf\nreboot\n~~~\n\nSource: http://www.fit-pc.com/wiki/index.php/Application_note_-_Example_code_for_capturing_power_button_event_on_fitlet2_running_Linux\n\n## Setting acpi\n\nsudo apt install acpid-support\n\nEdit or create file : /etc/acpi/events/power\n\n~~~\nevent=button/power\naction=/etc/acpi/power.sh\n~~~\n\nCreate file : /etc/acpi/power.sh\n\n~~~bash\n#!/bin/sh\nsystemctl suspend\n~~~\n\nthen:\n\n~~~console\nchmod +x /etc/acpi/power.sh\n~~~\n\n\nthen restart the service:\n\n~~~\nsudo service acpid restart\n~~~\n\nHint, if this is still not working, this is probably due to the event name.\n\nTo capture it you can run `acpi_listen` on the machine to see if event name is ok.\n\nIn my case, I was trying event `/button/power` but it works only with `power (PBTN)`\n\n# Setting remote wakeonlan\n\nBy default i've set my router like this:\n\n* redirect 8009 port to wol port (9)\n* redirect this steam onto my specific miniserver via udp\n\n\nAnd that's all!\n\nI can use : https://www.depicus.com/wake-on-lan/woli\n\nAnd then provide my mac adress and ip with port 8009 and that's enough.\n\nA simple alias would be:\n\n~~~\nalias wolminiserver='wakeonlan -i $(dig +short my_host_name) -p 8009 my_mac_address\n~~~\n\nNote the dig that allows to get ip from hostname ;)\n\n\n",
    "iso8601Date": "2021-12-12T10:18:10+01:00",
    "basename": "wakeonlan-server"
  }
}
